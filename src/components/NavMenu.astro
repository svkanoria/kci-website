---
import { mapPageLinks, PageLink, removeTrailingSlash } from "../utils";
import NavGroupTitle from "./NavGroupTitle.astro";

interface Props {
  pageLinks: Record<string, PageLink[]>;
  isCompact?: boolean;
}

const { pageLinks, isCompact } = Astro.props;

const currentPath = new URL(Astro.request.url).pathname;
---

<ul class:list={["menu bg-base-100", { "menu-compact": isCompact }]}>
  {
    mapPageLinks(
      (links, group) => (
        <>
          <NavGroupTitle group={group} />
          {links.map((link) => (
            <li>
              <a
                href={link.href}
                class={
                  removeTrailingSlash(currentPath) ===
                  removeTrailingSlash(link.href)
                    ? "active"
                    : ""
                }
              >
                {link.title}
              </a>
            </li>
          ))}
        </>
      ),
      pageLinks
    )
  }
</ul>
