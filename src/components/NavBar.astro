---
import { getPageLink, getPageLinks } from "../utils";
import NavBarItem from "./navBar/NavBarItem.astro";

const aboutPageLink = await getPageLink(
  import.meta.glob("../pages/about/index.astro")
);

const aboutPageLinks = await getPageLinks(
  import.meta.glob("../pages/about/*.{astro,md,mdx,html}")
);

const productPageLink = await getPageLink(
  import.meta.glob("../pages/products/index.astro")
);

const productPageLinks = await getPageLinks(
  import.meta.glob("../pages/products/*.{astro,md,mdx,html}")
);
---

<div class="drawer">
  <input id="main-nav" type="checkbox" class="drawer-toggle" />
  <div class="drawer-content flex flex-col">
    <!-- Navbar -->
    <div class="w-full navbar bg-base-300">
      <div class="navbar-start">
        <div class="flex-none lg:hidden">
          <label for="main-nav" class="btn btn-square btn-ghost">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              class="inline-block w-6 h-6 stroke-current"
              ><path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"></path></svg
            >
          </label>
        </div>
        <div class="flex-1 px-2 mx-2"><a href="/">KCI</a></div>
      </div>
      <div class="navbar-center">
        <div class="flex-none hidden lg:block">
          <ul class="menu menu-horizontal">
            <li tabindex="0">
              <NavBarItem
                pageLink={aboutPageLink}
                className="justify-between"
              />
              <ul class="p-2 bg-base-200">
                {
                  aboutPageLinks.map((page) => (
                    <li>
                      <NavBarItem pageLink={page} />
                    </li>
                  ))
                }
              </ul>
            </li>
            <li tabindex="0">
              <NavBarItem
                pageLink={productPageLink}
                className="justify-between"
              />
              <ul class="p-2 bg-base-200">
                {
                  productPageLinks.map((page) => (
                    <li>
                      <NavBarItem pageLink={page} />
                    </li>
                  ))
                }
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <div class="navbar-end"></div>
    </div>
    <!-- Page content here -->
    <slot />
  </div>
  <div class="drawer-side">
    <label for="main-nav" class="drawer-overlay"></label>
    <ul class="menu p-4 w-80 bg-base-100">
      <li>
        <NavBarItem pageLink={aboutPageLink} />
      </li>
      <ul class="px-4">
        {
          aboutPageLinks.map((page) => (
            <li>
              <NavBarItem pageLink={page} />
            </li>
          ))
        }
      </ul>
      <li>
        <NavBarItem pageLink={productPageLink} />
      </li>
      <ul class="px-4">
        {
          productPageLinks.map((page) => (
            <li>
              <NavBarItem pageLink={page} />
            </li>
          ))
        }
      </ul>
    </ul>
  </div>
</div>
